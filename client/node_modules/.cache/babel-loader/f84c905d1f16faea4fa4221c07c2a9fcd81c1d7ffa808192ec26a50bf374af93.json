{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mili\\\\Desktop\\\\messenger\\\\client\\\\src\\\\components\\\\Chat.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from 'react';\nimport { io } from 'socket.io-client';\nimport '../styles.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SERVER = 'http://localhost:5000';\nexport default function Chat({\n  username,\n  token,\n  onLogout\n}) {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [users, setUsers] = useState([]);\n  const [text, setText] = useState('');\n  const socketRef = useRef(null);\n  const listRef = useRef(null);\n  useEffect(() => {\n    fetch(`${SERVER}/messages`).then(r => r.json()).then(setMessages).catch(() => {});\n    const socket = io(SERVER, {\n      auth: {\n        token\n      }\n    });\n    socketRef.current = socket;\n    socket.on('connect', () => {\n      console.log('socket connected', socket.id);\n    });\n    socket.on('message', msg => {\n      setMessages(prev => [...prev, msg]);\n    });\n    socket.on('users', u => setUsers(u));\n    socket.on('connect_error', err => {\n      console.warn('connect_error', err.message);\n    });\n    return () => socket.disconnect();\n  }, [token]);\n  useEffect(() => {\n    if (listRef.current) listRef.current.scrollTop = listRef.current.scrollHeight;\n  }, [messages]);\n  function send() {\n    const t = text.trim();\n    if (!t) return;\n    socketRef.current.emit('message', {\n      text: t\n    });\n    setText('');\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-panel\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [\"Zalogowany jako: \", /*#__PURE__*/_jsxDEV(\"b\", {\n            children: username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 46,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 46,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: onLogout && /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn secondary\",\n            onClick: onLogout,\n            children: \"Wyloguj\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 47,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: listRef,\n        className: \"messages\",\n        children: messages.map(m => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"message\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"meta\",\n            children: [m.username, \" \\xB7 \", /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                color: 'var(--muted)'\n              },\n              children: new Date(m.time).toLocaleTimeString()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 52,\n              columnNumber: 52\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 52,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: m.text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 53,\n            columnNumber: 15\n          }, this)]\n        }, m.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 51,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"input-row\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"input\",\n          value: text,\n          onChange: e => setText(e.target.value),\n          onKeyDown: e => e.key === 'Enter' && send(),\n          placeholder: \"Napisz wiadomo\\u015B\\u0107...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn\",\n          onClick: send,\n          children: \"Wy\\u015Blij\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"sidebar\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"Online\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"online-list\",\n          children: users.map((u, i) => /*#__PURE__*/_jsxDEV(\"li\", {\n            children: u\n          }, i, false, {\n            fileName: _jsxFileName,\n            lineNumber: 67,\n            columnNumber: 34\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 5\n  }, this);\n}\n_s(Chat, \"BuFNMQDWE9My8y4pttEhNKRUPKM=\");\n_c = Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useEffect","useState","useRef","io","jsxDEV","_jsxDEV","SERVER","Chat","username","token","onLogout","_s","messages","setMessages","users","setUsers","text","setText","socketRef","listRef","fetch","then","r","json","catch","socket","auth","current","on","console","log","id","msg","prev","u","err","warn","message","disconnect","scrollTop","scrollHeight","send","t","trim","emit","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","ref","map","m","style","color","Date","time","toLocaleTimeString","value","onChange","e","target","onKeyDown","key","placeholder","i","_c","$RefreshReg$"],"sources":["C:/Users/mili/Desktop/messenger/client/src/components/Chat.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\r\nimport { io } from 'socket.io-client';\r\nimport '../styles.css';\r\n\r\nconst SERVER = 'http://localhost:5000';\r\n\r\nexport default function Chat({ username, token, onLogout }) {\r\n  const [messages, setMessages] = useState([]);\r\n  const [users, setUsers] = useState([]);\r\n  const [text, setText] = useState('');\r\n  const socketRef = useRef(null);\r\n  const listRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    fetch(`${SERVER}/messages`).then(r => r.json()).then(setMessages).catch(()=>{});\r\n    const socket = io(SERVER, { auth: { token } });\r\n    socketRef.current = socket;\r\n    socket.on('connect', () => {\r\n      console.log('socket connected', socket.id);\r\n    });\r\n    socket.on('message', (msg) => {\r\n      setMessages(prev => [...prev, msg]);\r\n    });\r\n    socket.on('users', (u) => setUsers(u));\r\n    socket.on('connect_error', (err) => {\r\n      console.warn('connect_error', err.message);\r\n    });\r\n    return () => socket.disconnect();\r\n  }, [token]);\r\n\r\n  useEffect(() => {\r\n    if (listRef.current) listRef.current.scrollTop = listRef.current.scrollHeight;\r\n  }, [messages]);\r\n\r\n  function send() {\r\n    const t = text.trim();\r\n    if (!t) return;\r\n    socketRef.current.emit('message', { text: t });\r\n    setText('');\r\n  }\r\n\r\n  return (\r\n    <div className=\"chat\">\r\n      <div className=\"chat-panel\">\r\n        <div className=\"header\">\r\n          <div>Zalogowany jako: <b>{username}</b></div>\r\n          <div>{onLogout && <button className=\"btn secondary\" onClick={onLogout}>Wyloguj</button>}</div>\r\n        </div>\r\n        <div ref={listRef} className=\"messages\">\r\n          {messages.map(m => (\r\n            <div key={m.id} className=\"message\">\r\n              <div className=\"meta\">{m.username} · <span style={{color:'var(--muted)'}}>{new Date(m.time).toLocaleTimeString()}</span></div>\r\n              <div>{m.text}</div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n        <div className=\"input-row\">\r\n          <input className=\"input\" value={text} onChange={e=>setText(e.target.value)} onKeyDown={e=>e.key==='Enter' && send()} placeholder=\"Napisz wiadomość...\" />\r\n          <button className=\"btn\" onClick={send}>Wyślij</button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"sidebar\">\r\n        <div className=\"card\">\r\n          <h4>Online</h4>\r\n          <ul className=\"online-list\">\r\n            {users.map((u, i) => <li key={i}>{u}</li>)}\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}